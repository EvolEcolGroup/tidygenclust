<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>fastmixture algorithm for population genetics clustering — gt_fastmixture • tidygenclust</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="fastmixture algorithm for population genetics clustering — gt_fastmixture"><meta property="og:description" content="This function implements the fastmixture algorithm for population genetics
clustering by calling the python module. If you use this function, make sure
that you cite the relevant paper by Santander, Refoyo-Martínez, and Meisner
(2024)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidygenclust</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/tidygenclust.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>fastmixture algorithm for population genetics clustering</h1>

    <div class="hidden name"><code>gt_fastmixture.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function implements the fastmixture algorithm for population genetics
clustering by calling the python module. If you use this function, make sure
that you cite the relevant paper by Santander, Refoyo-Martínez, and Meisner
(2024).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gt_fastmixture</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">k</span>,</span>
<span>  n_runs <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  threads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span>,</span>
<span>  outprefix <span class="op">=</span> <span class="st">"fastmixture"</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  tole <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  batches <span class="op">=</span> <span class="fl">32</span>,</span>
<span>  supervised <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  check <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  power <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  output_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  chunk <span class="op">=</span> <span class="fl">8192</span>,</span>
<span>  als_iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  als_tole <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  no_freqs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  random_init <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  safety <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>either a <code><a href="https://evolecolgroup.github.io/tidypopgen/reference/gen_tibble.html" class="external-link">tidypopgen::gen_tibble</a></code>, or the name of the binary plink
file (without the .bed extension)</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>the number of ancestral components (clusters), either a single value
or a vector</p></dd>


<dt id="arg-n-runs">n_runs<a class="anchor" aria-label="anchor" href="#arg-n-runs"></a></dt>
<dd><p>the number of repeats for each k value</p></dd>


<dt id="arg-threads">threads<a class="anchor" aria-label="anchor" href="#arg-threads"></a></dt>
<dd><p>the number of threads to use (1)</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>the random seed (defaults to 42);it should be a vector of length
<code>repeats</code></p></dd>


<dt id="arg-outprefix">outprefix<a class="anchor" aria-label="anchor" href="#arg-outprefix"></a></dt>
<dd><p>the prefix of the output files (fastmixture)</p></dd>


<dt id="arg-iter">iter<a class="anchor" aria-label="anchor" href="#arg-iter"></a></dt>
<dd><p>the maximum number of iterations (1000)</p></dd>


<dt id="arg-tole">tole<a class="anchor" aria-label="anchor" href="#arg-tole"></a></dt>
<dd><p>the tolerance in log-likelihood units between iterations (0.5)</p></dd>


<dt id="arg-batches">batches<a class="anchor" aria-label="anchor" href="#arg-batches"></a></dt>
<dd><p>the number of maximum mini-batches (32)</p></dd>


<dt id="arg-supervised">supervised<a class="anchor" aria-label="anchor" href="#arg-supervised"></a></dt>
<dd><p>the name fo the file with the supervised labels (NULL)</p></dd>


<dt id="arg-check">check<a class="anchor" aria-label="anchor" href="#arg-check"></a></dt>
<dd><p>the number of iterations to check for convergence (5)</p></dd>


<dt id="arg-power">power<a class="anchor" aria-label="anchor" href="#arg-power"></a></dt>
<dd><p>number of power iterations in randomised SVD (11)</p></dd>


<dt id="arg-output-path">output_path<a class="anchor" aria-label="anchor" href="#arg-output-path"></a></dt>
<dd><p>the path where q matrices will be saved id save_q= TRUE</p></dd>


<dt id="arg-chunk">chunk<a class="anchor" aria-label="anchor" href="#arg-chunk"></a></dt>
<dd><p>the number of SPs in chunk operations (8192)</p></dd>


<dt id="arg-als-iter">als_iter<a class="anchor" aria-label="anchor" href="#arg-als-iter"></a></dt>
<dd><p>the maximum number of iterations in the ALS algorithm (1000)</p></dd>


<dt id="arg-als-tole">als_tole<a class="anchor" aria-label="anchor" href="#arg-als-tole"></a></dt>
<dd><p>the tolerance for the RMSE of P between iterations (1e-4)</p></dd>


<dt id="arg-no-freqs">no_freqs<a class="anchor" aria-label="anchor" href="#arg-no-freqs"></a></dt>
<dd><p>do not save P-matrix (TRUE)</p></dd>


<dt id="arg-random-init">random_init<a class="anchor" aria-label="anchor" href="#arg-random-init"></a></dt>
<dd><p>random initialisation of parameters (TRUE)</p></dd>


<dt id="arg-safety">safety<a class="anchor" aria-label="anchor" href="#arg-safety"></a></dt>
<dd><p>add extra safety steps in unstable optimizations (TRUE)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>an object of class <code>gt_admix</code>. See <code><a href="https://evolecolgroup.github.io/tidypopgen/reference/gt_admixture.html" class="external-link">tidypopgen::gt_admixture()</a></code> for
details.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function returns a q_matrix that can be plotted with <code>autoplot</code>, and
tidied with <code>tidy</code> methods from the <code>tidypopgen</code> package.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>C. G. Santander, A. Refoyo Martinez, J. Meisner (2024) Faster
model-based estimation of ancestry proportions. bioRxiv 2024.07.08.602454;
doi: https://doi.org/10.1101/2024.07.08.602454</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Eirlys Tysall, Hovhannisyan Anahit, Andrea Pozzi, Cecilia Padilla-Iglesias, Michela Leonardi, Aramish Fatima, Ondrej Pelanek, Nile Stephenson, Margherita Colucci, Andrea Manica.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

